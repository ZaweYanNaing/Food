<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Management System - API Test</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .test-button { background: #f97316; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .test-button:hover { background: #ea580c; }
        .result { background: #f3f4f6; padding: 15px; border-radius: 5px; margin: 10px 0; white-space: pre-wrap; font-family: monospace; }
        .success { border-left: 4px solid #10b981; }
        .error { border-left: 4px solid #ef4444; }
        h1 { color: #f97316; }
        h2 { color: #374151; }
    </style>
</head>
<body>
    <h1>üç≥ Recipe Management System - API Test</h1>
    <p>This page tests all the Recipe Management API endpoints to ensure they're working correctly.</p>

    <div class="test-section">
        <h2>1. Get All Categories</h2>
        <button class="test-button" onclick="testGetCategories()">Test Get Categories</button>
        <div id="categories-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>2. Get All Recipes</h2>
        <button class="test-button" onclick="testGetRecipes()">Test Get Recipes</button>
        <div id="recipes-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>3. Create New Recipe</h2>
        <button class="test-button" onclick="testCreateRecipe()">Test Create Recipe</button>
        <div id="create-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>4. Search Recipes</h2>
        <button class="test-button" onclick="testSearchRecipes()">Test Search Recipes</button>
        <div id="search-result" class="result"></div>
    </div>

    <div class="test-section">
        <h2>5. Get Recipe by ID</h2>
        <button class="test-button" onclick="testGetRecipeById()">Test Get Recipe by ID</button>
        <div id="get-by-id-result" class="result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080/api';

        async function makeRequest(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });
                
                const data = await response.json();
                return { success: true, data, status: response.status };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        function displayResult(elementId, result, title) {
            const element = document.getElementById(elementId);
            if (result.success) {
                element.className = 'result success';
                element.innerHTML = `‚úÖ ${title} - SUCCESS\nStatus: ${result.status}\n\n${JSON.stringify(result.data, null, 2)}`;
            } else {
                element.className = 'result error';
                element.innerHTML = `‚ùå ${title} - ERROR\n\n${result.error}`;
            }
        }

        async function testGetCategories() {
            const result = await makeRequest('/recipes/categories');
            displayResult('categories-result', result, 'Get Categories');
        }

        async function testGetRecipes() {
            const result = await makeRequest('/recipes');
            displayResult('recipes-result', result, 'Get All Recipes');
        }

        async function testCreateRecipe() {
            const recipeData = {
                title: "API Test Recipe",
                description: "This recipe was created via API test",
                ingredients: "Test ingredient 1, Test ingredient 2, Test ingredient 3",
                instructions: "1. Test step one\n2. Test step two\n3. Test step three",
                cooking_time: 45,
                difficulty: "Medium",
                user_id: 1,
                categories: [1, 3] // Breakfast and Dinner
            };

            const result = await makeRequest('/recipes', {
                method: 'POST',
                body: JSON.stringify(recipeData)
            });
            displayResult('create-result', result, 'Create Recipe');
        }

        async function testSearchRecipes() {
            const result = await makeRequest('/recipes/search?q=pancake&difficulty=Easy');
            displayResult('search-result', result, 'Search Recipes');
        }

        async function testGetRecipeById() {
            const result = await makeRequest('/recipes/1');
            displayResult('get-by-id-result', result, 'Get Recipe by ID');
        }

        // Auto-run tests when page loads
        window.onload = function() {
            console.log('üß™ Recipe Management System Test Page Loaded');
            console.log('üì° Backend API should be running on: http://localhost:8080');
            console.log('üåê Frontend should be running on: http://localhost:5173');
        };
    </script>
</body>
</html>
